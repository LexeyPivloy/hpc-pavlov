
<div>
    <h1>Произведение матриц</h1>
    <p>В таблице ниже приведены значения замеров времени для перемножения матриц в зависимости от размерностей этих матриц. Были проведены эксперименты с использованием библиотеки numpy(работает на CPU, и скорее всего на нем и параллелит), cupy(работает также как numpy, только на GPU), numba(позволяет написать код для python для выполнения поставленной задачи и задавать количество thread'ов и block'ов). А так же присутствует реализация ядра на C++ (столбец в таблице: gpu) и время работы без распаралеливания (столбец в таблице: cpu).</p>
    <p>Последние два столбца показывают ускорение работы программы с использованием ядра на C++ относительно однопоточной реализации (acc (gpu>cpu)) и библиотеки numpy (acc (gpu>numpy)).</p>
</div>



|   size |     numpy | cpu                 |      cupy |     numba |       gpu | acc (gpu>cpu)      |   acc (gpu>numpy) |
|-------:|----------:|:--------------------|----------:|----------:|----------:|:-------------------|------------------:|
|    100 | 0.0012813 | 0.6531157000000007  | 0.0001995 | 0.0001332 | 6.53e-05  | 10001.771822470366 |          19.6217  |
|    200 | 0.0008796 | 5.094904500000002   | 0.0001956 | 0.0001245 | 2.25e-05  | 226440.19999963397 |          39.0933  |
|    400 | 0.0079696 | 35.835469399999994  | 0.0005386 | 0.0001176 | 2.12e-05  | 1690352.330830544  |         375.925   |
|    800 | 0.041451  | 275.1239298         | 0.0118828 | 0.0002024 | 3.76e-05  | 7317125.795540386  |        1102.42    |
|   1600 | 0.33482   | too boring          | 0.0005439 | 0.0001468 | 2.22e-05  | too much           |       15082       |
|   2000 | 0.632763  | too boring          | 0.0004142 | 0.0001292 | 2.19e-05  | too much           |       28893.3     |


<h3><i>Вывод</i>: Реализация данной задачи на cpu слишком медленная, даже при использовании библиотеки numpy.Распараллеливание на gpu (а особенно реализация ядра на C++) для данной задачи на порядки ускоряет её выполнение </h3>
<h4>P.S.: Не стал считать время на одном потоке для размерностей > 800, т.к при увеличении размерностей матриц в 2 раза, время увеличивается в ~5-10 раз</h4>

![](https://github.com/LexeyPivloy/hpc-pavlov/blob/main/static/nerd-emoji.gif)